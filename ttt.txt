ä¸€æœµç¾ä¸½çš„èŒ‰è‰ğŸŒ¹â˜…


buleoceanbank_20210708_1	41

æ”¾æ¬¾ï¼š
æ ¸å¿ƒé•¿è´¦	-	æœªå¹³è´¦	2021-07-21	è“æµ·é“¶è¡Œ	è“æµ·é“¶è¡Œ	202107213050752756925793058
000LIA2021070000162571    æ–‡ä»¶é‡Œå°±æ²¡æœ‰   äº‘çª—ä¹Ÿæ²¡æœ‰


  
è¿˜æ¬¾ ï¼š
7-2   æ ¸å¿ƒçŸ­è´¦çš„ï¼Œç•Œé¢ä¸Šéƒ½æ²¡æœ‰æ ¸å¿ƒå€Ÿæ®å·ï¼Œç¬¬ä¸‰æ–¹å·000LIA2020090000116424åœ¨è¡¨fund_escrow_infoé‡Œèƒ½æŸ¥å‡ºæ¥20200925702818320281

æ ¸å¿ƒé•¿è´¦ 7-4   åœ¨ç›¸åº”æ–‡ä»¶æ‰¾ä¸åˆ°è®°å½•  åœ¨7-3å·çš„äº‘çª—é‡Œæ‰¾åˆ°buleoceanbank_20210703_1


select
  *
from
  fund_escrow_info
where
  core_escrow_no='202106303050733755990462167';å¹³è´¦ä¸€è‡´çš„ï¼Œæ ¸å¿ƒå€Ÿæ®å·åˆ°åº“é‡ŒæŸ¥ï¼Œæ²¡æœ‰æ•°æ®
  
  WITH t1 as( select DISTINCT * from hdp_jinrong_tech_defaultdb.capital_icbc_account 
  where create_time in('${today1}','${tomorrow1}','${ttomorrow1}') and batch_id='${batchId}' 
  and transType=1 ),t2 as ( --æ‰˜ç®¡è´¦outeræ­£å¸¸è¿˜æ¬¾ 
  select DISTINCT taskDetail.core_escrow_no, taskDetail.third_escrow_no, escrow.busi_escrow_no,
  (CASE WHEN (taskDetail.repay_type='ADV_SETTLE_REPAY'OR taskDetail.repay_type='BUYBACK') 
  then 'A' else taskDetail.start_term_num end) as term_no, 
  taskDetail.start_term_num, taskDetail.paid_prin, taskDetail.paid_int, 
  taskDetail.paid_pen, taskDetail.paid_comp, taskDetail.paid_txn_fee, taskDetail.paid_amt, 
  taskDetail.repay_time, term.remain_prin, taskDetail.detail_no, escrow.total_terms, 
  term.schd_prin, term.schd_int, term.schd_amt, term.schd_repay_date, escrow.lend_amt, repCustLoan.PRODUCT_CD,
  DATEDIFF(term.paid_repay_date,term.schd_repay_date) as over_date,--é€¾æœŸå¤©æ•° 
  (Case when (term.repay_type='NORMAL_REPAY' OR term.repay_type='ADV_REPAY') 
  then 1 when term.repay_type='ADV_SETTLE_REPAY' then 2 when term.repay_type='OVERDUE_REPAY'
  then 4 when term.repay_type='COMP_REPAY' then 7 when term.repay_type='BUYBACK' then 8 else 0 end) 
  as repay_way,--è¿˜æ¬¾ç±»å‹ (case when taskDetail.repay_type='BUYBACK' then 3 
  when taskDetail.repay_type='COMP_REPAY' then 4 else 1 end) as transType,--3ä¸ºå›è´­4ä¸ºä»£å¿1ä¸ºè¿˜æ¬¾
  get_json_object(task.detail_info,'$.repayTotalInfos[0].payOrderId') as payOrderId, 
  get_json_object(task.detail_info,'$.repayTotalInfos[0].orderAmt') as realAmt 
  FROM hdp_jinrong_qiangui_defaultdb.itf_cw_t_fund_repay_task_detail taskDetail LEFT JOIN 
  hdp_jinrong_qiangui_defaultdb.itf_db58_escrowledger_fund_escrow_term_view term on term.escrow_no=taskDetail.escrow_no 
  and term.term_num=taskDetail.start_term_num left join hdp_jinrong_qiangui_defaultdb.itf_cw_t_fund_escrow_info escrow 
  on escrow.escrow_no=taskDetail.escrow_no left join 
  hdp_jinrong_qiangui_defaultdb.itf_db58_escrowledger_fund_repay_detail_view detail 
  on taskDetail.repay_task_no=detail.relate_task_no left join hdp_jinrong_qiangui_defaultdb.itf_cw_t_fund_repay_task task 
  on task.task_no=taskDetail.repay_task_no left join hdp_jinrong_qiangui_defaultdb.itf_new_hx_db58_loanpost_rep_cust_loan_view repCustLoan 
  on repCustLoan.bill_no=taskDetail.core_escrow_no and repCustLoan.daystr='${yesterday1}' where taskDetail.daystr='${yesterday1}' 
  and term.daystr='${yesterday1}' and detail.daystr='${yesterday1}' and escrow.daystr='${yesterday1}' 
  and task.daystr='${yesterday1}' and term.fund_post_date='${yestodayBillDate}' and escrow.capital_no 
  in ('fcode_bank_blueocean') and detail.deal_status='S' ),t3 as( select 0, '${batchId}' as batch_id,--æ‰¹æ¬¡å· 
  (CASE WHEN t1.amt = t2.paid_amt THEN 200 WHEN t1.receiptId IS NULL THEN 302 WHEN t2.detail_no IS NULL THEN 301 ELSE 300 END ) 
  AS result, (CASE WHEN t1.amt = t2.paid_amt THEN 200 ELSE 300 END )AS error_type, 
  (CASE WHEN t1.amt = t2.paid_amt THEN 200 ELSE 300 END ) AS status, IFNULL(t1.receiptId,t2.third_escrow_no) 
  as order_id_connect,--å†…éƒ¨å…³è”æµæ°´å· IFNULL(t2.third_escrow_no,'-') as order_id_third,--èµ„æ–¹æ”¾æ¬¾å€Ÿæ®å· IFNULL(t2.core_escrow_no,'-') 
  as order_id_core,--æ ¸å¿ƒæ”¾æ¬¾å€Ÿæ®å· IFNULL(t2.repay_time,t1.accounting_date) as trans_finish_time_inner,--å®è¿˜æ¬¾æ—¥ 
  IFNULL(t2.schd_repay_date,t1.accounting_date) as plan_repay_time,--è®¡åˆ’è¿˜æ¬¾æ—¶é—´ IFNULL(t2.paid_amt,0) as pay_amt_inner,--è¿˜æ¬¾æ€»é¢ 
  IFNULL(t1.amt,0) as pay_amt_outer, IFNULL(t2.transType,t1.transType) as trans_type_inner, IFNULL(t2.PRODUCT_CD,'-') as product_cd, 
  IFNULL(t2.third_escrow_no,t1.receiptId) as receipt_id,--æ”¾æ¬¾å€Ÿæ®å· IFNULL(t2.total_terms,0) as term_no,--æ€»æœŸæ•° IFNULL(t2.start_term_num,0) 
  as current_term_no,--å½“å‰æœŸ IFNULL(t2.remain_prin,0) as remain_repay_amt, IFNULL(t2.schd_amt,0) as plan_repay_total_amt, 
  IFNULL(t2.schd_prin,0) as plan_repay_prin, IFNULL(t2.schd_int,0) as plan_repay_int, 0 as plan_repay_fee,0 as plan_repay_other_fee, 
  ( CASE WHEN t2.over_date is null THEN 0 when t2.over_date<=0 Then 0 ELSE t2.over_date END ) as over_date,--é€¾æœŸå¤©æ•° 0 
  as plan_repay_over_penalty_amt,0 as plan_advance_repay_amt, IFNULL(t2.paid_amt,0) as real_repay_total_amt, 
  IFNULL(t2.paid_prin,0) as real_repay_prin, IFNULL(t2.paid_int,0) as real_repay_int, 
  IFNULL(t2.paid_txn_fee,0) as real_repay_fee,0 as real_repay_other_fee, IFNULL(t2.paid_pen,0) as real_repay_over_penalty_amt,
  0 as real_advance_repay_amt, IFNULL(t2.repay_way,0) as repay_way, 0 as pay_channel_id, IFNULL(t2.realAmt,0) as bill_view_amt,
  IFNULL(t2.lend_amt,0) as lend_amt, 'buleocean' as capital_code, FROM_UNIXTIME( UNIX_TIMESTAMP( ) ) AS create_time, 
  FROM_UNIXTIME( UNIX_TIMESTAMP( ) ) AS update_time, '' as remark, 
  IFNULL(t1.accounting_date,FROM_UNIXTIME(unix_timestamp('1970-01-01 00:00:00','yyyy-MM-dd HH:mm:ss'))) as fund_post_time,--èµ„æ–¹å…¥è´¦æ—¥
  '' as pay_order_id --æ”¯ä»˜æµæ°´å· from t1 FULL JOIN t2 on t1.receiptId=t2.third_escrow_no and t1.term_no=t2.term_no ) select * from t3

CREATE TABLE `recon_batches_info` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `batch_id` varchar(100) NOT NULL DEFAULT '' COMMENT 'æ‰¹æ¬¡å·ï¼šlianlian_20190526_1',
  `stage` int(255) NOT NULL DEFAULT '1' COMMENT 'å¯¹è´¦é˜¶æ®µ1ï¼ˆåˆå§‹ï¼‰ã€2ï¼ˆå¤–ä¾§æ•°æ®åŠ è½½å®Œæˆç­‰å¾…å¯¹è´¦ï¼‰ã€3ï¼ˆå¯¹è´¦å®Œæˆï¼‰',
  `config_id` bigint(20) NOT NULL DEFAULT '0' COMMENT 'æ¸ é“id',
  `repeat_count` int(255) NOT NULL DEFAULT '0' COMMENT 'é‡è¯•æ¬¡æ•°',
  `create_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `stauts` int(11) NOT NULL DEFAULT '1' COMMENT '1:æˆåŠŸ2ï¼šå¤„ç†ä¸­3ï¼šå¤±è´¥',
  `job_id` bigint(20) NOT NULL DEFAULT '0' COMMENT 'ä¸»ä»»åŠ¡Id',
  `error_msg` varchar(255) NOT NULL DEFAULT '',
  `data_count` bigint(20) NOT NULL DEFAULT '0' COMMENT 'æ•°æ®æ¡æ•°',
  PRIMARY KEY (`id`),
  KEY `idx_batch_id` (`batch_id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=10979 DEFAULT CHARSET=utf8 COMMENT='å¯¹è´¦æ‰¹æ¬¡è¡¨'



CREATE TABLE `recon_check_result_consumer_finance` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®',
  `batch_id` varchar(100) NOT NULL DEFAULT '' COMMENT 'æ‰¹æ¬¡å·ï¼šlianlian_20190526_1',
  `result` int(11) NOT NULL DEFAULT '0' COMMENT 'å¯¹è´¦ç»“æœ(200(ä¸€è‡´)ã€300ï¼ˆä¸ä¸€è‡´ï¼‰ã€301ï¼ˆæ ¸å¿ƒçŸ­è´¦ï¼‰ã€302(æ ¸å¿ƒé•¿è´¦))',
  `error_type` int(11) NOT NULL DEFAULT '0' COMMENT 'ä¸ä¸€è‡´åŸå› ï¼ˆ300ï¼ˆé‡‘é¢ä¸ä¸€è‡´ï¼‰200ä¸ºä¸€è‡´',
  `status` int(11) NOT NULL DEFAULT '0' COMMENT 'å¹³è´¦çŠ¶æ€ï¼ˆ200ï¼ˆä¸éœ€è¦å¹³è´¦ï¼‰ï¼ˆ201ï¼‰ï¼ˆæ‰‹å·¥å¹³è´¦ï¼‰300ï¼ˆæœªå¹³è´¦ï¼‰400ï¼ˆéš”æ—¥å†å¹³ï¼‰ï¼‰',
  `order_id_connect` varchar(100) NOT NULL DEFAULT '' COMMENT 'ç”¨äºå¯¹è´¦å…³è”æµæ°´å·',
  `order_id_third` varchar(100) NOT NULL DEFAULT '' COMMENT 'ä¸‰æ–¹æµæ°´å·',
  `order_id_core` varchar(100) NOT NULL DEFAULT '' COMMENT 'æ ¸å¿ƒå€Ÿæ®å·',
  `trans_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT 'äº¤æ˜“å®Œæˆæ—¶é—´,ä¸‰æ–¹',
  `plan_repay_time` date NOT NULL DEFAULT '1970-01-01' COMMENT 'è®¡åˆ’è¿˜æ¬¾æ—¶é—´',
  `pay_amt_inner` decimal(20,2) NOT NULL DEFAULT '0.00' COMMENT 'æ”¯ä»˜é‡‘é¢ï¼Œæ ¸å¿ƒï¼Œå•ä½å…ƒ',
  `pay_amt_outer` decimal(20,2) NOT NULL DEFAULT '0.00' COMMENT 'æ”¯ä»˜é‡‘é¢ï¼Œä¸‰æ–¹ï¼Œå•ä½å…ƒ',
  `trans_type` int(10) NOT NULL DEFAULT '0' COMMENT 'äº¤æ˜“ç±»å‹ 1:è¿˜æ¬¾ 3å›è´­ 4ä»£å¿',
  `product_cd` varchar(255) NOT NULL DEFAULT '' COMMENT 'è´·æ¬¾äº§å“ç¼–å·',
  `receipt_id` varchar(255) NOT NULL DEFAULT '' COMMENT 'ä¸šåŠ¡è®¢å•å·',
  `term_no` int(10) NOT NULL DEFAULT '0' COMMENT 'æ€»æœŸæ•°',
  `current_term_no` int(10) NOT NULL DEFAULT '0' COMMENT 'å½“å‰æœŸæ•°',
  `remain_repay_amt` decimal(20,2) NOT NULL DEFAULT '0.00' COMMENT 'å‰©ä½™è¿˜æ¬¾åœ¨è´·æœ¬é‡‘ï¼ˆè´·æ¬¾æœ¬é‡‘-å·²è¿˜æœ¬é‡‘ï¼‰',
  `plan_repay_total_amt` decimal(20,2) NOT NULL DEFAULT '0.00' COMMENT 'å½“æœŸç”¨æˆ·åº”è¿˜æ€»é¢(æœ¬é‡‘+åˆ©æ¯+è´¹ç”¨)',
  `plan_repay_prin` decimal(20,2) NOT NULL DEFAULT '0.00' COMMENT 'å½“æœŸç”¨æˆ·åº”è¿˜æœ¬é‡‘',
  `plan_repay_int` decimal(20,2) NOT NULL DEFAULT '0.00' COMMENT 'å½“æœŸç”¨æˆ·åº”è¿˜åˆ©æ¯',
  `plan_repay_fee` decimal(20,2) NOT NULL DEFAULT '0.00' COMMENT 'å½“æœŸç”¨æˆ·åº”è¿˜æ‰‹ç»­è´¹ç”¨(æœåŠ¡è´¹+åˆ†æœŸæœåŠ¡è´¹)',
  `plan_repay_other_fee` decimal(20,2) unsigned NOT NULL COMMENT 'å½“æœŸç”¨æˆ·åº”è¿˜å…¶ä»–è´¹ç”¨',
  `over_date` int(10) NOT NULL DEFAULT '0' COMMENT 'é€¾æœŸå¤©æ•°',
  `plan_repay_over_penalty_amt` decimal(20,2) NOT NULL COMMENT 'å½“æœŸç”¨æˆ·åº”è¿˜ç½šæ¯',
  `plan_advance_repay_amt` decimal(20,2) NOT NULL COMMENT 'å½“å‰ç”¨æˆ·åº”è¿˜æå‰è¿˜æ¬¾è´¹ç”¨',
  `real_repay_total_amt` decimal(20,2) NOT NULL COMMENT 'å®æ”¶è¿˜æ¬¾æ€»é¢',
  `real_repay_prin` decimal(20,2) NOT NULL COMMENT 'å®æ”¶è¿˜æ¬¾æœ¬é‡‘',
  `real_repay_int` decimal(20,2) NOT NULL COMMENT 'å®æ”¶è¿˜æ¬¾åˆ©æ¯',
  `real_repay_fee` decimal(20,2) NOT NULL DEFAULT '0.00' COMMENT 'å®æ”¶è¿˜æ¬¾æœåŠ¡è´¹ç”¨',
  `real_repay_other_fee` decimal(20,2) NOT NULL DEFAULT '0.00' COMMENT 'å®æ”¶è¿˜æ¬¾å…¶ä»–è´¹ç”¨',
  `real_repay_over_penalty_amt` decimal(20,2) NOT NULL COMMENT 'å®æ”¶è¿˜æ¬¾ç½šæ¯',
  `real_advance_repay_amt` decimal(20,2) NOT NULL COMMENT 'å®æ”¶è¿˜æ¬¾æå‰è¿˜æ¬¾è´¹ç”¨',
  `repay_way` int(20) NOT NULL COMMENT 'æ­¤æ¬¡è¿˜æ¬¾çš„çš„æ–¹å¼ï¼ŒåŒ…å«1ã€æ­£å¸¸è¿˜æ¬¾ï¼›2ã€æå‰ç»“æ¸…ï¼›3ã€æå‰è¿˜å½“æœŸï¼›4ã€é€¾æœŸè¿˜æ¬¾ï¼›5ã€é€€æ¬¾ï¼›6ã€æå‰éƒ¨åˆ†è¿˜æ¬¾ï¼›7ã€é€¾æœŸä»£å¿ï¼›8ã€é€¾æœŸå›è´­',
  `pay_channel_id` varchar(255) NOT NULL COMMENT 'æ”¯ä»˜æ¸ é“äº§å“id',
  `bill_view_amt` decimal(20,2) NOT NULL DEFAULT '0.00' COMMENT 'å¯¹è´¦å•æ˜¾ç¤ºæ€»é‡‘é¢(ä¸€èˆ¬å‡å»æ‹…ä¿æœåŠ¡è´¹)',
  `lend_total_amt` decimal(20,2) NOT NULL DEFAULT '0.00' COMMENT 'è´·æ¬¾æ€»æœ¬é‡‘',
  `capital_code` varchar(50) NOT NULL DEFAULT '',
  `create_time` datetime NOT NULL DEFAULT '1970-01-01 00:00:00' COMMENT 'å…¥åº“æ—¶é—´ï¼Œä¹Ÿå¯åšå¯¹è´¦æ—¶é—´',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `remark` varchar(255) NOT NULL DEFAULT '' COMMENT 'å¤‡æ³¨',
  `fund_post_time` date NOT NULL DEFAULT '1970-01-01' COMMENT 'èµ„æ–¹å…¥è´¦æ—¶é—´',
  `pay_order_id` varchar(50) NOT NULL DEFAULT '' COMMENT 'æ”¯ä»˜è®¢å•å·',
  PRIMARY KEY (`id`),
  KEY `idx_batch_id` (`batch_id`) USING BTREE,
  KEY `idx_result_create_time` (`result`,`create_time`),
  KEY `idx_order_id_connect` (`order_id_connect`),
  KEY `idx_order_id_core` (`order_id_core`),
  KEY `idx_capital_create_trans_type` (`create_time`,`capital_code`,`trans_time`,`trans_type`) USING BTREE,
  KEY `idx_trans_capital` (`trans_time`,`capital_code`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=14866340 DEFAULT CHARSET=utf8mb4 COMMENT='è´¢ä¿¡å¯¹è´¦ç»“æœè¡¨'
	
CREATE TABLE `fund_escrow_info` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT 'id',
  `escrow_no` varchar(64) NOT NULL COMMENT 'æ‰˜ç®¡è´¦ä¿¡æ¯ç¼–å·',
  `lend_order_no` varchar(64) NOT NULL COMMENT 'æ”¾æ¬¾è®¢å•ç¼–å·',
  `third_escrow_no` varchar(64) NOT NULL COMMENT 'ä¸‰æ–¹è´¦å•ç¼–å·',
  `busi_escrow_no` varchar(64) NOT NULL COMMENT 'ä¸šåŠ¡è´¦å•ç¼–å·',
  `core_escrow_no` varchar(64) NOT NULL COMMENT 'æ ¸å¿ƒè´¦å•ç¼–å·',
  `assets_no` varchar(16) NOT NULL COMMENT 'èµ„äº§æ–¹ç¼–å·',
  `capital_no` varchar(64) NOT NULL COMMENT 'èµ„é‡‘æ–¹ç¼–å·',
  `lend_amt` decimal(15,2) NOT NULL DEFAULT '0.00' COMMENT 'æ”¾æ¬¾é‡‘é¢',
  `lend_date` date NOT NULL COMMENT 'æ”¾æ¬¾æ—¥',
  `value_date` date NOT NULL COMMENT 'èµ·æ¯æ—¥',
  `expire_date` date DEFAULT NULL COMMENT 'åˆ°æœŸæ—¥',
  `term_num` int(11) NOT NULL COMMENT 'å½“å‰æœŸ',
  `total_terms` int(11) NOT NULL COMMENT 'æ€»æœŸæ•°',
  `paid_prin` decimal(15,2) NOT NULL COMMENT 'å·²è¿˜æœ¬é‡‘',
  `settle_date` date DEFAULT NULL COMMENT 'ç»“æ¸…æ—¥',
  `escrow_type` varchar(32) NOT NULL COMMENT 'æ‰˜ç®¡è´¦ç±»å‹',
  `escrow_status` varchar(32) NOT NULL COMMENT 'æ‰˜ç®¡è´¦çŠ¶æ€',
  `exist_compen` int(1) NOT NULL DEFAULT '0' COMMENT 'æ˜¯å¦å­˜åœ¨ä»£å¿',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`) USING BTREE,
  UNIQUE KEY `uniq_escrow_no` (`escrow_no`) USING BTREE,
  UNIQUE KEY `uniq_third_escrow_no` (`third_escrow_no`) USING BTREE,
  UNIQUE KEY `uniq_core_escrow_no` (`core_escrow_no`) USING BTREE,
  KEY `idx_lend_order_no` (`lend_order_no`) USING BTREE,
  KEY `idx_busi_escrow_no` (`busi_escrow_no`)
) ENGINE=InnoDB AUTO_INCREMENT=1127590 DEFAULT CHARSET=utf8 COMMENT='æ‰˜ç®¡è´¦ä¿¡æ¯'
	{
  "okFileName":"001_000UC010005337849_${today1}_E002OK.txt",
  "tails": [
    "F|${data.size()}"
  ],
  "okBodys": [
    "H|${fc:ceil(fc:random()*9999)}${df:format(\"yyyyMMdd\",-1)}${df:format(\"yyyyMMdd\",0)}|000UC010005337849|001_000UC010005337849_${today1}_E002OK.txt|E002|${data.size()}|${today1}",
   "D|001_000UC010005337849_${today1}_E002.txt|",
    "F|${data.size()}"
  ],
  "heads": [
    "H|${fc:ceil(fc:random()*9999)}${df:format(\"yyyyMMdd\",-1)}${df:format(\"yyyyMMdd\",0)}|000UC010005337849|001_000UC010005337849_${today1}_E002.txt|E002|${data.size()}|${decimal:sum(data.stream().map(b->b.getTradeAmt()).toList()).toPlainString()}|${today1}||||"
 ]
}


{
	"okFileName":"001_000UC010000224079_${today1}_E002OK.txt",
	"tails": [
		"F|${data.size()}"
	],
	"okBodys": [
		"H|${fc:ceil(fc:random()*9999)}${df:format(\"yyyyMMdd\",-1)}${df:format(\"yyyyMMdd\",0)}|000UC010000224079|001_000UC010000224079_${today1}_E002.txt|E002|${data.size()}|${today1}",
		"D|001_000UC010000224079_${today1}_D002.txt|",
		"F|${data.size()}"
	],
	"heads": [
		"H|${fc:ceil(fc:random()*9999)}${df:format(\"yyyyMMdd\",-1)}${df:format(\"yyyyMMdd\",0)}|000UC010000224079|000UC010000224079_${today1}_E002.txt|E002|${data.size()}|${decimal:sum(data.stream().map(b->b.getTradeAmt()).toList()).toPlainString()}|${today1}||||"
	]
}